<div class"app-header">
    <div class="header-title" k="ចុះឈ្មោះ">Register</div>
    <div class="back" ng-click="myGoBack()">
        <span class="close ion-ios-close-empty"></span>
    </div>
</div>
<ion-view hide-nav-bar="true" class="header-view">
    <ion-content>  
        <div class="lg">
            <div class="a">
                <button><span class="fa fa-facebook-official"></span> <span k="ចុះឈ្មោះតាម Facebook">Register with Facebook</span></button>                
            </div>
            <div class="b">_______________OR_______________</div>
            <div class="c">
                <form id="register_form">
                    <div class="d">
                        <div class="e"><span class="ion-person"></span></div>
                        <div class="f"><input k="ឈ្មោះ" id="full_name" placeholder="Full Name" type="text">
                            <span style="display:none" class="input-close ion-ios-close-outline"></span>
                        </div>
                    </div>
                    <div class="d">
                        <div class="e"><span class="ion-ios-telephone"></span></div>
                        <div class="f"><input k="លេខទូរស័ព្ទ" id="phone_number" placeholder="Phone Number" type="numbeer" pattern="\d*"r">
                            <span style="display:none" class="input-close ion-ios-close-outline"></span>
                        </div>
                    </div>
                    <div class="d">
                        <div class="e"><span class="ion-ios-locked"></span></div>
                        <div class="f"><input k="លេខសំងាត់" id="password" placeholder="Password" type="password">
                            <span style="display:none" class="input-close ion-ios-close-outline"></span>
                        </div>
                    </div>
                    <div class="g">
                        <button onclick="submitRegister()" type="submit" k="បង្កើតគណនី">Create my Account</button>                
                    </div>
                </form>
            </div>
            <div class="i" k="បានចុះឈ្មោះរួចហើយ?">Already have an account? <span><a href="#tab/sign_in" k="ចុះឈ្មោះ">Sign in</a></div>
        </div>
  </ion-content>
</ion-view>
<script>    
    la();
    $('#register_form input').on('keyup', function(){
        if ($(this).val() != '') {
            $(this).siblings('.input-close').show();
        }
    });
    $('#register_form .input-close').on('click', function(){
        $(this).hide();
        $(this).siblings('input').val('');
    });
    
    function submitRegister(){
        var full_name = $('#register_form #full_name').val();
        var phone = $('#register_form #phone_number').val();
        var password = $('#register_form #password').val();
        if (full_name.length == 0){
            alert('Please enter your full name');
        } else if (phone.length == 0) {
            alert('Please enter your phone number.');
        } else if (password.length == 0) {
            alert('Please enter your password.');
        } else {
            $.post('http://www.nekoten.khmerqq.com/app/register.php',{full_name:full_name, phone:phone, password:password},function(data){
                var a = JSON.parse(data);
                
                if (a['result'] == 'success'){
                    /*
                    localStorage.setItem('user_id', a['user_id']);
                    localStorage.setItem('full_name', a['full_name']);
                    localStorage.setItem('phone_number', a['phone_number']);
                    */
                    alert('You account has been created');
                    
                } else if (a['result'] == 'phone') {
                    alert('This phone number is already in use.');    
                } else {
                    alert(data);
                }
                
            });
        }        
    }
</script>